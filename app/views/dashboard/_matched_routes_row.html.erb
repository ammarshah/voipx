<% routes.each do |route| %>
  <tr>
    <td>
      <%= route.breakout.destination %>
    </td>
    <td>
      <%= route.purchase_type.humanize + 'ing at $' + route.price.to_s %>
    </td>
    <td>
      <%= link_to route.user.name, user_path(route.user), target: "_blank" %>
    </td>
    <td>
      <div id="favorite_<%= route.id %>" class="pull-left">
        <% if current_user.favorites.pluck(:route_id).include?(route.id) %>
          <%= link_to current_user.favorites.where(route_id: route.id).first, method: :delete, title: "Remove from favorites", remote: true do %>
            <i class="fa fa-star"></i>
          <% end %>
        <% else %>
          <%= link_to favorites_path(route_id: route.id), method: :post, title: 'Add to favorites', remote: true do %>
            <i class="fa fa-star-o"></i>
          <% end %>
        <% end %>
      </div>
      
      <% purchase_sentence = route.purchase_type.humanize + 'ing at $' + route.price.to_s %>
      <% subject = route.breakout.destination + ' (' + route.breakout.code + ')' + ' - ' + route.quality_type.upcase + ' - ' + purchase_sentence %>
      <button type="button" class="btn btn-primary btn-sm pull-right" data-toggle="modal" data-target="#messageModal" data-recipient="<%= route.user.id%>" data-subject="<%= subject %>" data-profile-url="<%= url_for(route.user) %>" data-photo-url="<%= route.user.photo.url(:thumb) %>" data-name="<%= route.user.name %>" data-purchase-sentence="<%= purchase_sentence %>" data-destination="<%= route.breakout.destination %>" data-breakout="<%= route.breakout.code %>" data-price="<%= route.price %>" data-quality-type="<%= route.quality_type.upcase %>" >
        Message
      </button>
    </td>
  </tr>
<% end %>